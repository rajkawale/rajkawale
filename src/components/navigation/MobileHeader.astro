---
import LinkedInIcon from '../icons/LinkedInIcon';
import GithubIcon from '../icons/GithubIcon';

const currentPath = Astro.url.pathname;

const isActive = (path: string) => {
  if (path === '/') return currentPath === '/';
  return currentPath.startsWith(path);
};
---

<!-- Mobile Header: Top Bar -->
<header class="mobile-header flex md:hidden fixed top-0 left-0 w-full z-50 px-6 py-6 justify-between items-center bg-transparent">
  <!-- Left: Brand Logo -->
  <a 
    href="/" 
    id="mobile-logo"
    class="text-4xl font-serif tracking-tight text-white transition-all duration-300 ease-out flex items-center hover:drop-shadow-[0_0_4px_rgba(255,255,255,0.8)]"
  >
    <span class="font-light">Raj</span>
    <span class="font-black"> Kawale</span>
  </a>

  <!-- Right: Hamburger Menu Trigger -->
  <button
    id="mobile-menu-trigger"
    class="moonlight-container text-white hover:text-white transition-all duration-300 ease-out p-2 z-50"
    aria-label="Open menu"
    aria-expanded="false"
  >
    <svg
      class="w-6 h-6"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M4 6h16M4 12h16"
      ></path>
    </svg>
  </button>
</header>

<!-- Mobile Menu Overlay -->
<div
  id="mobile-menu-overlay"
  class="mobile-menu-overlay fixed inset-0 z-[9999] hidden md:hidden"
>
  <div class="mobile-menu-content flex flex-col h-full">
    <!-- Top: Close Button -->
    <div class="mobile-menu-top flex justify-end p-6">
      <button
        id="mobile-menu-close"
        class="text-white hover:text-gray-300 transition-colors p-2 z-[10000]"
        aria-label="Close menu"
      >
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </button>
    </div>

    <!-- Center: Navigation Links -->
    <nav class="mobile-menu-center flex flex-col items-center justify-center gap-8 flex-1 px-6">
      <a
        href="/"
        class="mobile-menu-link text-3xl font-serif text-white transition-all duration-300 ease-out hover:opacity-100 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.6)]"
      >
        Home
      </a>
      <a
        href="/#projects"
        class="mobile-menu-link text-3xl font-serif text-white transition-all duration-300 ease-out hover:opacity-100 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.6)]"
      >
        Work
      </a>
      <a
        href="/blog"
        class="mobile-menu-link text-3xl font-serif text-white transition-all duration-300 ease-out hover:opacity-100 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.6)]"
      >
        Writing
      </a>
      <a
        href="/contact"
        class="mobile-menu-link text-3xl font-serif text-white transition-all duration-300 ease-out hover:opacity-100 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.6)]"
      >
        Contact
      </a>
      
      <!-- Social Icons - Near Contact -->
      <div class="flex items-center justify-center gap-6 mt-4">
        <a
          href="https://github.com/rajkawale"
          target="_blank"
          rel="noopener noreferrer"
          class="social-icon-link transition-all duration-300 hover:opacity-100 hover:drop-shadow-[0_0_12px_rgba(255,255,255,0.8)]"
          aria-label="GitHub"
        >
          <GithubIcon client:load className="w-7 h-7" />
        </a>
        <a
          href="https://www.linkedin.com/in/rajkawale/"
          target="_blank"
          rel="noopener noreferrer"
          class="social-icon-link transition-all duration-300 hover:opacity-100 hover:drop-shadow-[0_0_12px_rgba(255,255,255,0.8)]"
          aria-label="LinkedIn"
        >
          <LinkedInIcon client:load className="w-7 h-7" />
        </a>
      </div>
    </nav>
  </div>
</div>

<script>
  const mobileLogo = document.getElementById('mobile-logo');

  // Scroll fade effect for logo
  window.addEventListener('scroll', () => {
    const scrollY = window.scrollY;
    
    if (scrollY > 50) {
      mobileLogo?.classList.add('opacity-0', 'pointer-events-none');
    } else {
      mobileLogo?.classList.remove('opacity-0', 'pointer-events-none');
    }
  });

  // Hamburger Menu Toggle
  document.addEventListener('DOMContentLoaded', () => {
    const menuTrigger = document.getElementById('mobile-menu-trigger');
    const menuClose = document.getElementById('mobile-menu-close');
    const menuOverlay = document.getElementById('mobile-menu-overlay');
    const body = document.body;

    function openMenu() {
      if (menuOverlay) {
        menuOverlay.classList.remove('hidden');
        // Small delay to trigger animation
        setTimeout(() => {
          menuOverlay.classList.add('menu-open');
        }, 10);
        body.style.overflow = 'hidden'; // Prevent body scroll
      }
      if (menuTrigger) {
        menuTrigger.setAttribute('aria-expanded', 'true');
      }
    }

    function closeMenu() {
      if (menuOverlay) {
        menuOverlay.classList.remove('menu-open');
        setTimeout(() => {
          menuOverlay.classList.add('hidden');
        }, 300); // Match transition duration
        body.style.overflow = ''; // Restore body scroll
      }
      if (menuTrigger) {
        menuTrigger.setAttribute('aria-expanded', 'false');
      }
    }

    // Toggle menu on hamburger click
    if (menuTrigger) {
      menuTrigger.addEventListener('click', openMenu);
    }

    // Close menu on close button click
    if (menuClose) {
      menuClose.addEventListener('click', closeMenu);
    }

    // Close menu when clicking on overlay background
    if (menuOverlay) {
      menuOverlay.addEventListener('click', (e) => {
        if (e.target === menuOverlay) {
          closeMenu();
        }
      });
    }

    // Close menu when clicking on navigation links
    const menuLinks = document.querySelectorAll('.mobile-menu-link');
    menuLinks.forEach((link) => {
      link.addEventListener('click', () => {
        closeMenu();
      });
    });

    // Close menu on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && menuOverlay && !menuOverlay.classList.contains('hidden')) {
        closeMenu();
      }
    });
  });
</script>

<style>
  /* Mobile Menu Overlay */
  .mobile-menu-overlay {
    background: rgba(13, 13, 18, 0.95);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.3s ease-out, transform 0.3s ease-out;
  }

  .mobile-menu-overlay.menu-open {
    opacity: 1;
    transform: translateY(0);
  }

  .mobile-menu-content {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  .mobile-menu-top {
    flex-shrink: 0;
  }

  .mobile-menu-center {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  .mobile-menu-link {
    opacity: 0.9;
    text-align: center;
    -webkit-tap-highlight-color: transparent;
  }

  .mobile-menu-link:active {
    opacity: 1;
    transform: scale(1.05);
  }

  .social-icon-link {
    opacity: 0.9;
    color: white;
    -webkit-tap-highlight-color: transparent;
  }

  .social-icon-link:active {
    opacity: 1;
    transform: scale(1.1);
  }

  /* Hide on desktop */
  @media (min-width: 768px) {
    .mobile-menu-overlay {
      display: none !important;
    }
  }

  .moonlight-container:hover {
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.5);
  }
</style>


