---
import BaseLayout from '../../components/BaseLayout.astro';
import { container } from '../../core/di/container';
import ArticleRow from '../../components/ui/ArticleRow.astro';

const blogService = container.getBlogService();
const allPosts = await blogService.getAllPosts();
// Posts are already sorted by date (newest first) from the repository
const latestPost = allPosts[0];
const olderPosts = allPosts.slice(1);
---

<BaseLayout
  title="Writing - Raj Kawale"
  description="Thoughts on product management, AI, and building systems-driven products"
>
  <main class="min-h-screen bg-[#020617] text-zinc-300 py-24 px-6 md:px-12 relative z-10" style="padding-top: 150px;">
    <div class="max-w-4xl mx-auto">
      <header class="mb-12 border-b border-zinc-800 pb-6">
        <h1 class="text-4xl md:text-5xl font-serif font-bold text-white mb-4">
          Writing
        </h1>
        <p class="text-lg text-zinc-300 font-sans">
          Insights on product management, AI innovation, and building scalable systems.
        </p>
      </header>
      
      {allPosts.length > 0 ? (
        <div>
          <!-- Featured Post Card - Full Width Glass Card -->
          {latestPost && (
            <a
              href={`/blog/${latestPost.slug}`}
              class="writing-featured-card block w-full bg-white/[0.03] backdrop-blur-xl border border-white/10 rounded-lg p-8 md:p-10 mb-12 transition-all duration-300 ease-out"
            >
              <h2 class="text-2xl md:text-3xl font-serif font-bold text-white mb-4 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.6)] transition-all duration-300 ease-out">
                {latestPost.title}
              </h2>
              {latestPost.excerpt && (
                <p class="text-base text-zinc-300 mb-4 font-sans line-clamp-2 leading-relaxed">
                  {latestPost.excerpt}
                </p>
              )}
              <time
                datetime={latestPost.publishedAt.toISOString()}
                class="text-sm text-zinc-500 font-sans"
              >
                {latestPost.publishedAt.toLocaleDateString('en-US', {
                  month: 'short',
                  day: 'numeric',
                  year: 'numeric',
                })}
              </time>
            </a>
          )}

          <!-- Archive List - Simple Vertical List -->
          {olderPosts.length > 0 && (
            <div>
              {olderPosts.map((post) => (
                <ArticleRow post={post} />
              ))}
            </div>
          )}
        </div>
      ) : (
        <div class="bg-white/[0.03] backdrop-blur-xl border border-white/10 rounded-lg p-12 text-center border-t-white/20">
          <p class="text-lg text-zinc-300 font-sans">
            No blog posts yet. Posts will appear here once the Blogger sync script runs.
          </p>
          <p class="mt-4 text-sm text-zinc-500 font-mono">
            Run <code class="bg-zinc-950/50 px-2 py-1 rounded border border-zinc-800">npm run sync:blog</code> to fetch posts.
          </p>
        </div>
      )}
    </div>
  </main>
</BaseLayout>

<style>
  /* Glass Card Hover Effect - Matching Work Section */
  .writing-featured-card {
    transition: all 0.3s ease-out;
  }

  .writing-featured-card:hover {
    border-color: rgba(255, 255, 255, 0.3);
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
  }
</style>


